---
global:
  nameOverride: blocky

image:
  repository: ghcr.io/0xerr0r/blocky
  tag: v0.19
  pullPolicy: IfNotPresent

env:
  TZ: America/New_York

configmap:
  blocky-config:
    enabled: true
    # Ripped from here: https://github.com/k8s-at-home/charts/blob/master/charts/stable/blocky/values.yaml
    data:
      config.yml: |
        upstream:
          default:
            - 10.45.0.1
            - 8.8.8.8
        upstreamTimeout: 1s
        blocking:
          blackLists:
            ads:
              - https://s3.amazonaws.com/lists.disconnect.me/simple_ad.txt
              - https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts
              - https://mirror1.malwaredomains.com/files/justdomains
              - http://sysctl.org/cameleon/hosts
              - https://zeustracker.abuse.ch/blocklist.php?download=domainblocklist
              - https://s3.amazonaws.com/lists.disconnect.me/simple_tracking.txt
        caching:
          minTime: 5m
          maxTime: -1
          maxItemsCount: 0
          prefetching: true
          prefetchExpires: 2h
          prefetchThreshold: 5
          prefetchMaxItemsCount: 0

service:
  main:
    enabled: false
  dns-tcp:
    enabled: true
    type: ClusterIP
    externalTrafficPolicy: Local
    annotations:
      metallb.universe.tf/allow-shared-ip: blocky-svc
      metallb.universe.tf/loadBalancerIPs: 10.56.1.20
    ports:
      dns-tcp:
        enabled: true
        protocol: TCP
        port: 53
        targetPort: 53
  dns-udp:
    enabled: true
    type: ClusterIP
    externalTrafficPolicy: Local
    annotations:
      metallb.universe.tf/allow-shared-ip: blocky-svc
      metallb.universe.tf/loadBalancerIPs: 10.56.1.20
    ports:
      dns-udp:
        enabled: true
        protocol: UDP
        port: 53
        targetPort: 53

ingress:
  main:
    enabled: false

persistence:
  logs:
    enabled: true
    storageClass: ssd
    accessMode: ReadWriteMany
    size: 1Gi
