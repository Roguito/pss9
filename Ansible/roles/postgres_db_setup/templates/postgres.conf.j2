#------------------------------------------------------------------------------
# DIRECTORY SETUP
#------------------------------------------------------------------------------

data_directory    = '/var/lib/postgresql/{{ postgres_settings['version'] }}/main'           # use data in another directory
hba_file          = '/etc/postgresql/{{ postgres_settings['version'] }}/main/pg_hba.conf'   # host-based authentication file
ident_file        = '/etc/postgresql/{{ postgres_settings['version'] }}/main/pg_ident.conf' # ident configuration file
external_pid_file = '/var/run/postgresql/{{ postgres_settings['version'] }}-main.pid'       # write an extra PID file

#------------------------------------------------------------------------------
# CONNECTIONS AND AUTHENTICATION
#------------------------------------------------------------------------------

listen_addresses = '{{ postgres_settings['listening_addr'] }}'
port              = {{ postgres_settings['listening_port'] }}
max_connections   = 100         	# (change requires restart)
unix_socket_directories = '/var/run/postgresql'

ssl = on
ssl_cert_file = '/etc/ssl/certs/ssl-cert-snakeoil.pem'
ssl_key_file  = '/etc/ssl/private/ssl-cert-snakeoil.key'
# authentication_timeout = 1min         # 1s-600s
# ssl_ciphers = 'HIGH:MEDIUM:+3DES:!aNULL' # allowed SSL ciphers
# ssl_prefer_server_ciphers = on
# ssl_ecdh_curve = 'prime256v1'
# ssl_dh_params_file = ''
# ssl_ca_file  = ''
# ssl_crl_file = ''
# password_encryption = md5  # md5 or scram-sha-256
# db_user_namespace = off
# row_security = on

#------------------------------------------------------------------------------
# RESOURCE USAGE (except WAL)
#------------------------------------------------------------------------------

shared_buffers             = 128MB  # min 128kB
dynamic_shared_memory_type = posix  # the default is the first option

#------------------------------------------------------------------------------
# ERROR REPORTING AND LOGGING
#------------------------------------------------------------------------------

cluster_name    = '{{ postgres_settings['version'] }}/main'
log_line_prefix = '%m [%p] %q%u@%d '
log_timezone    = 'Etc/UTC'

#------------------------------------------------------------------------------
# RUNTIME STATISTICS
#------------------------------------------------------------------------------

stats_temp_directory = '/var/run/postgresql/{{ postgres_settings['version'] }}-main.pg_stat_tmp'

#------------------------------------------------------------------------------
# CLIENT CONNECTION DEFAULTS
#------------------------------------------------------------------------------

datestyle                  = 'iso, mdy'
timezone                   = 'Etc/UTC'
lc_messages                = 'C.UTF-8'          # locale for system error message
lc_monetary                = 'C.UTF-8'          # locale for monetary formatting
lc_numeric                 = 'C.UTF-8'          # locale for number formatting
lc_time                    = 'C.UTF-8'          # locale for time formatting
default_text_search_config = 'pg_catalog.english'

#------------------------------------------------------------------------------
# CONFIG FILE INCLUDES
#------------------------------------------------------------------------------

include_dir = 'conf.d'
